# Atomic Red Team Test Mappings for Credential Access Detections
# Maps detection rules to specific Atomic tests for validation

mappings:
  - detection: sigma/rules/credential_dumping_lsass.yml
    description: LSASS Memory Access Detection
    atomic_tests:
      - technique: T1003.001
        name: LSASS Memory Dump
        test_numbers: [1, 2, 3]
    log_sources:
      - sysmon
    platforms:
      - windows
    expected_events:
      - event_id: 10
        description: Process access to lsass.exe
    validation:
      - check: event_id == 10
      - check: target_image contains 'lsass.exe'
      - check: granted_access in ['0x1010', '0x1410', '0x1fffff']

  - detection: panther/rules/sysmon_suspicious_process.py
    description: Suspicious Process Detection
    atomic_tests:
      - technique: T1059.001
        name: PowerShell Download Cradle
        test_numbers: [1, 2, 3, 4]
      - technique: T1059.003
        name: Command Shell Execution
        test_numbers: [1]
    log_sources:
      - sysmon
    platforms:
      - windows
      - linux
    expected_events:
      - event_id: 1
        description: Process creation with suspicious command line

  - detection: sigma/rules/suspicious_powershell_download.yml
    description: PowerShell Download Detection
    atomic_tests:
      - technique: T1059.001
        name: PowerShell
        test_numbers: [1, 2, 5, 6]
      - technique: T1105
        name: Ingress Tool Transfer
        test_numbers: [1, 2]
    log_sources:
      - sysmon
      - powershell
    platforms:
      - windows
    expected_events:
      - event_id: 1
        description: PowerShell process with download command
      - event_id: 4104
        source: PowerShell
        description: Script block logging
